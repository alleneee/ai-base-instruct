---
description: 
globs: 
alwaysApply: false
---
# 企业知识库平台项目架构

本项目是一个基于LlamaIndex构建的企业级知识库平台。主要功能包括文档处理、向量化索引、语义检索和自适应知识处理。

## 主要模块结构

- `enterprise_kb/` - 主项目目录
  - `api/` - API接口模块
  - `core/` - 核心功能模块
  - `db/` - 数据库相关模块
  - `models/` - 数据模型定义
  - `schemas/` - 数据验证架构
  - `services/` - 业务服务层
  - `storage/` - 存储管理模块
  - `utils/` - 工具函数
  - `main.py` - 应用程序入口点

## 关键组件说明

### 自适应文档处理系统

自适应文档处理系统是平台的核心特性，能够智能分析文档并选择最佳处理路径。

关键文件:
- [enterprise_kb/storage/document_processor.py](mdc:enterprise_kb/storage/document_processor.py) - 包含自适应文档处理器实现
- [enterprise_kb/api/documents_extended.py](mdc:enterprise_kb/api/documents_extended.py) - 文档处理API

核心类:
- `DocumentProcessor` - 文档处理器主类
- `DocumentAnalyzer` - 文档分析器，评估文档特征和复杂度
- `AdaptiveChunkingStrategy` - 自适应分块策略，根据文档类型选择最佳分块参数

### API接口

API接口提供了与平台交互的RESTful端点。

关键文件:
- [enterprise_kb/main.py](mdc:enterprise_kb/main.py) - 应用入口和路由注册
- [enterprise_kb/api/retrieval.py](mdc:enterprise_kb/api/retrieval.py) - 检索相关API

### 存储系统

存储系统管理向量数据和原始文档。

关键文件:
- [enterprise_kb/storage/vector_store_manager.py](mdc:enterprise_kb/storage/vector_store_manager.py) - 向量存储管理器
- [enterprise_kb/utils/milvus_client.py](mdc:enterprise_kb/utils/milvus_client.py) - Milvus客户端封装

## 数据流

1. 文档上传 → 文档分析 → 自适应处理策略选择
2. 根据文档类型决定是否转换为Markdown
3. 使用最佳分块策略切分文档
4. 向量化处理并存储到向量数据库
5. 构建检索索引供后续查询

## 配置与设置

主要配置在[enterprise_kb/core/config/settings.py](mdc:enterprise_kb/core/config/settings.py)中定义，包括:
- 文档处理参数
- 向量数据库连接信息
- API与安全设置

## 扩展指南

要添加新的文档处理能力:
1. 在`DocumentAnalyzer`中添加新的分析方法
2. 在`AdaptiveChunkingStrategy`中添加对应的分块策略
3. 更新`document_processor.py`中的处理逻辑
4. 在API层添加相应的接口
